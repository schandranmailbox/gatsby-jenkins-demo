{"version":3,"sources":["@wordpress/compose/src/hooks/use-dialog/index.js"],"names":["mergeRefs","useRef","useEffect","ESCAPE","useConstrainedTabbing","useFocusOnMount","useFocusReturn","useFocusOutside","useCallbackRef","useDialog","options","onClose","current","constrainedTabbingRef","focusOnMountRef","focusReturnRef","focusOutsideProps","closeOnEscapeRef","node","addEventListener","event","keyCode","stopPropagation","tabIndex"],"mappings":";;;;;;AAAA;AACA;AACA;AACA,OAAOA,SAAP,MAAsB,kBAAtB;AAEA;AACA;AACA;;AACA,SAASC,MAAT,EAAiBC,SAAjB,QAAkC,oBAAlC;AACA,SAASC,MAAT,QAAuB,qBAAvB;AAEA;AACA;AACA;;AACA,OAAOC,qBAAP,MAAkC,4BAAlC;AACA,OAAOC,eAAP,MAA4B,uBAA5B;AACA,OAAOC,cAAP,MAA2B,qBAA3B;AACA,OAAOC,eAAP,MAA4B,sBAA5B;AACA,OAAOC,cAAP,MAA2B,qBAA3B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,SAAT,CAAoBC,OAApB,EAA8B;AAC7B,MAAMC,OAAO,GAAGV,MAAM,EAAtB;AACAC,EAAAA,SAAS,CAAE,YAAM;AAChBS,IAAAA,OAAO,CAACC,OAAR,GAAkBF,OAAO,CAACC,OAA1B;AACA,GAFQ,EAEN,CAAED,OAAO,CAACC,OAAV,CAFM,CAAT;AAGA,MAAME,qBAAqB,GAAGT,qBAAqB,EAAnD;AACA,MAAMU,eAAe,GAAGT,eAAe,EAAvC;AACA,MAAMU,cAAc,GAAGT,cAAc,EAArC;AACA,MAAMU,iBAAiB,GAAGT,eAAe,CAAEG,OAAO,CAACC,OAAV,CAAzC;AACA,MAAMM,gBAAgB,GAAGT,cAAc,CAAE,UAAEU,IAAF,EAAY;AACpD,QAAK,CAAEA,IAAP,EAAc;AACb;AACA;;AAEDA,IAAAA,IAAI,CAACC,gBAAL,CAAuB,SAAvB,EAAkC,UAAEC,KAAF,EAAa;AAC9C;AACA,UAAKA,KAAK,CAACC,OAAN,KAAkBlB,MAAlB,IAA4BQ,OAAO,CAACC,OAAzC,EAAmD;AAClDQ,QAAAA,KAAK,CAACE,eAAN;AACAX,QAAAA,OAAO,CAACC,OAAR;AACA;AACD,KAND;AAOA,GAZsC,EAYpC,EAZoC,CAAvC;AAcA,SAAO,CACNZ,SAAS,CAAE,CACVa,qBADU,EAEVE,cAFU,EAGVD,eAHU,EAIVG,gBAJU,CAAF,CADH,kCAQFD,iBARE;AASLO,IAAAA,QAAQ,EAAE;AATL,KAAP;AAYA;;AAED,eAAed,SAAf","sourcesContent":["/**\n * External dependencies\n */\nimport mergeRefs from 'react-merge-refs';\n\n/**\n * WordPress dependencies\n */\nimport { useRef, useEffect } from '@wordpress/element';\nimport { ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport useConstrainedTabbing from '../use-constrained-tabbing';\nimport useFocusOnMount from '../use-focus-on-mount';\nimport useFocusReturn from '../use-focus-return';\nimport useFocusOutside from '../use-focus-outside';\nimport useCallbackRef from '../use-callback-ref';\n\n/**\n * Returns a ref and props to apply to a dialog wrapper to enable the following behaviors:\n *  - constrained tabbing.\n *  - focus on mount.\n *  - return focus on unmount.\n *  - focus outside.\n *\n * @param {Object} options Dialog Options.\n */\nfunction useDialog( options ) {\n\tconst onClose = useRef();\n\tuseEffect( () => {\n\t\tonClose.current = options.onClose;\n\t}, [ options.onClose ] );\n\tconst constrainedTabbingRef = useConstrainedTabbing();\n\tconst focusOnMountRef = useFocusOnMount();\n\tconst focusReturnRef = useFocusReturn();\n\tconst focusOutsideProps = useFocusOutside( options.onClose );\n\tconst closeOnEscapeRef = useCallbackRef( ( node ) => {\n\t\tif ( ! node ) {\n\t\t\treturn;\n\t\t}\n\n\t\tnode.addEventListener( 'keydown', ( event ) => {\n\t\t\t// Close on escape\n\t\t\tif ( event.keyCode === ESCAPE && onClose.current ) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tonClose.current();\n\t\t\t}\n\t\t} );\n\t}, [] );\n\n\treturn [\n\t\tmergeRefs( [\n\t\t\tconstrainedTabbingRef,\n\t\t\tfocusReturnRef,\n\t\t\tfocusOnMountRef,\n\t\t\tcloseOnEscapeRef,\n\t\t] ),\n\t\t{\n\t\t\t...focusOutsideProps,\n\t\t\ttabIndex: '-1',\n\t\t},\n\t];\n}\n\nexport default useDialog;\n"]}