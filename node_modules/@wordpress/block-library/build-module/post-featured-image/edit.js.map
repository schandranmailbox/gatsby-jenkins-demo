{"version":3,"sources":["@wordpress/block-library/src/post-featured-image/edit.js"],"names":["useEntityProp","useSelect","Icon","ToggleControl","PanelBody","withNotices","InspectorControls","BlockControls","MediaPlaceholder","MediaReplaceFlow","BlockIcon","useBlockProps","__","sprintf","postFeaturedImage","ALLOWED_MEDIA_TYPES","placeholderChip","PostFeaturedImageDisplay","isLink","attributes","setAttributes","context","postId","postType","noticeUI","noticeOperations","featuredImage","setFeaturedImage","media","select","getMedia","onSelectImage","value","id","onUploadError","message","removeAllNotices","createErrorNotice","image","title","instructions","source_url","alt_text","PostFeaturedImageWithNotices","PostFeaturedImageEdit","props"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEntityProp } from '@wordpress/core-data';\nimport { useSelect } from '@wordpress/data';\nimport {\n\tIcon,\n\tToggleControl,\n\tPanelBody,\n\twithNotices,\n} from '@wordpress/components';\nimport {\n\tInspectorControls,\n\tBlockControls,\n\tMediaPlaceholder,\n\tMediaReplaceFlow,\n\tBlockIcon,\n\tuseBlockProps,\n} from '@wordpress/block-editor';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { postFeaturedImage } from '@wordpress/icons';\n\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\nconst placeholderChip = (\n\t<div className=\"post-featured-image_placeholder\">\n\t\t<Icon icon={ postFeaturedImage } />\n\t\t<p> { __( 'Featured Image' ) }</p>\n\t</div>\n);\n\nfunction PostFeaturedImageDisplay( {\n\tattributes: { isLink },\n\tsetAttributes,\n\tcontext: { postId, postType },\n\tnoticeUI,\n\tnoticeOperations,\n} ) {\n\tconst [ featuredImage, setFeaturedImage ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'featured_media',\n\t\tpostId\n\t);\n\tconst media = useSelect(\n\t\t( select ) =>\n\t\t\tfeaturedImage && select( 'core' ).getMedia( featuredImage ),\n\t\t[ featuredImage ]\n\t);\n\tconst onSelectImage = ( value ) => {\n\t\tif ( value?.id ) {\n\t\t\tsetFeaturedImage( value.id );\n\t\t}\n\t};\n\tfunction onUploadError( message ) {\n\t\tnoticeOperations.removeAllNotices();\n\t\tnoticeOperations.createErrorNotice( message );\n\t}\n\tlet image;\n\tif ( ! featuredImage ) {\n\t\timage = (\n\t\t\t<MediaPlaceholder\n\t\t\t\ticon={ <BlockIcon icon={ postFeaturedImage } /> }\n\t\t\t\tonSelect={ onSelectImage }\n\t\t\t\tnotices={ noticeUI }\n\t\t\t\tonError={ onUploadError }\n\t\t\t\taccept=\"image/*\"\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\tlabels={ {\n\t\t\t\t\ttitle: __( 'Featured image' ),\n\t\t\t\t\tinstructions: __(\n\t\t\t\t\t\t'Upload a media file or pick one from your media library.'\n\t\t\t\t\t),\n\t\t\t\t} }\n\t\t\t/>\n\t\t);\n\t} else {\n\t\t// We have a Featured image so show a Placeholder if is loading.\n\t\timage = ! media ? (\n\t\t\tplaceholderChip\n\t\t) : (\n\t\t\t<img\n\t\t\t\tsrc={ media.source_url }\n\t\t\t\talt={ media.alt_text || __( 'Featured image' ) }\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Link settings' ) }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ sprintf(\n\t\t\t\t\t\t\t// translators: %s: Name of the post type e.g: \"post\".\n\t\t\t\t\t\t\t__( 'Link to %s' ),\n\t\t\t\t\t\t\tpostType\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonChange={ () => setAttributes( { isLink: ! isLink } ) }\n\t\t\t\t\t\tchecked={ isLink }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<BlockControls>\n\t\t\t\t{ !! media && (\n\t\t\t\t\t<MediaReplaceFlow\n\t\t\t\t\t\tmediaId={ featuredImage }\n\t\t\t\t\t\tmediaURL={ media.source_url }\n\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\tonSelect={ onSelectImage }\n\t\t\t\t\t\tonError={ onUploadError }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</BlockControls>\n\t\t\t<div { ...useBlockProps() }>{ image }</div>\n\t\t</>\n\t);\n}\n\nconst PostFeaturedImageWithNotices = withNotices( PostFeaturedImageDisplay );\n\nexport default function PostFeaturedImageEdit( props ) {\n\tif ( ! props.context?.postId ) {\n\t\treturn placeholderChip;\n\t}\n\treturn <PostFeaturedImageWithNotices { ...props } />;\n}\n"]}