{"version":3,"sources":["@wordpress/block-library/src/template-part/edit/index.js"],"names":["TemplatePartEdit","attributes","slug","theme","tagName","TagName","setAttributes","clientId","templatePartId","select","getEntityRecord","hasFinishedResolution","getBlocks","getEntityArgs","entityRecord","hasResolvedEntity","innerBlocks","isResolved","isMissing","blockProps","isPlaceholder","isEntityAvailable","inspectorAdvancedControls","label","value","isOpen","onToggle","chevronUp","chevronDown","onClose","length"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport {\n\tBlockControls,\n\tInspectorAdvancedControls,\n\tuseBlockProps,\n\tWarning,\n} from '@wordpress/block-editor';\nimport {\n\tSelectControl,\n\tDropdown,\n\tToolbarGroup,\n\tToolbarButton,\n\tSpinner,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { chevronUp, chevronDown } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport TemplatePartNamePanel from './name-panel';\nimport TemplatePartInnerBlocks from './inner-blocks';\nimport TemplatePartPlaceholder from './placeholder';\nimport TemplatePartSelection from './selection';\n\nexport default function TemplatePartEdit( {\n\tattributes: { slug, theme, tagName: TagName = 'div' },\n\tsetAttributes,\n\tclientId,\n} ) {\n\tconst templatePartId = theme && slug ? theme + '//' + slug : null;\n\n\t// Set the postId block attribute if it did not exist,\n\t// but wait until the inner blocks have loaded to allow\n\t// new edits to trigger this.\n\tconst { isResolved, innerBlocks, isMissing } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEntityRecord, hasFinishedResolution } = select( 'core' );\n\t\t\tconst { getBlocks } = select( 'core/block-editor' );\n\n\t\t\tconst getEntityArgs = [\n\t\t\t\t'postType',\n\t\t\t\t'wp_template_part',\n\t\t\t\ttemplatePartId,\n\t\t\t];\n\t\t\tconst entityRecord = templatePartId\n\t\t\t\t? getEntityRecord( ...getEntityArgs )\n\t\t\t\t: null;\n\t\t\tconst hasResolvedEntity = templatePartId\n\t\t\t\t? hasFinishedResolution( 'getEntityRecord', getEntityArgs )\n\t\t\t\t: false;\n\n\t\t\treturn {\n\t\t\t\tinnerBlocks: getBlocks( clientId ),\n\t\t\t\tisResolved: hasResolvedEntity,\n\t\t\t\tisMissing: hasResolvedEntity && ! entityRecord,\n\t\t\t};\n\t\t},\n\t\t[ templatePartId, clientId ]\n\t);\n\n\tconst blockProps = useBlockProps();\n\tconst isPlaceholder = ! slug;\n\tconst isEntityAvailable = ! isPlaceholder && ! isMissing;\n\n\tif ( ! isPlaceholder && isMissing ) {\n\t\treturn (\n\t\t\t<TagName { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __(\n\t\t\t\t\t\t'Template part has been deleted or is unavailable.'\n\t\t\t\t\t) }\n\t\t\t\t</Warning>\n\t\t\t</TagName>\n\t\t);\n\t}\n\n\tconst inspectorAdvancedControls = (\n\t\t<InspectorAdvancedControls>\n\t\t\t<SelectControl\n\t\t\t\tlabel={ __( 'HTML element' ) }\n\t\t\t\toptions={ [\n\t\t\t\t\t{ label: __( 'Default (<div>)' ), value: 'div' },\n\t\t\t\t\t{ label: '<header>', value: 'header' },\n\t\t\t\t\t{ label: '<main>', value: 'main' },\n\t\t\t\t\t{ label: '<section>', value: 'section' },\n\t\t\t\t\t{ label: '<article>', value: 'article' },\n\t\t\t\t\t{ label: '<aside>', value: 'aside' },\n\t\t\t\t\t{ label: '<footer>', value: 'footer' },\n\t\t\t\t] }\n\t\t\t\tvalue={ TagName }\n\t\t\t\tonChange={ ( value ) => setAttributes( { tagName: value } ) }\n\t\t\t/>\n\t\t</InspectorAdvancedControls>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ inspectorAdvancedControls }\n\t\t\t<TagName { ...blockProps }>\n\t\t\t\t{ isPlaceholder && (\n\t\t\t\t\t<TemplatePartPlaceholder\n\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t\tinnerBlocks={ innerBlocks }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ isEntityAvailable && (\n\t\t\t\t\t<BlockControls>\n\t\t\t\t\t\t<ToolbarGroup className=\"wp-block-template-part__block-control-group\">\n\t\t\t\t\t\t\t<TemplatePartNamePanel postId={ templatePartId } />\n\t\t\t\t\t\t\t<Dropdown\n\t\t\t\t\t\t\t\tclassName=\"wp-block-template-part__preview-dropdown-button\"\n\t\t\t\t\t\t\t\tcontentClassName=\"wp-block-template-part__preview-dropdown-content\"\n\t\t\t\t\t\t\t\tposition=\"bottom right left\"\n\t\t\t\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\t\t\taria-expanded={ isOpen }\n\t\t\t\t\t\t\t\t\t\ticon={\n\t\t\t\t\t\t\t\t\t\t\tisOpen ? chevronUp : chevronDown\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tlabel={ __( 'Choose another' ) }\n\t\t\t\t\t\t\t\t\t\tonClick={ onToggle }\n\t\t\t\t\t\t\t\t\t\t// Disable when open to prevent odd FireFox bug causing reopening.\n\t\t\t\t\t\t\t\t\t\t// As noted in https://github.com/WordPress/gutenberg/pull/24990#issuecomment-689094119 .\n\t\t\t\t\t\t\t\t\t\tdisabled={ isOpen }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\trenderContent={ ( { onClose } ) => (\n\t\t\t\t\t\t\t\t\t<TemplatePartSelection\n\t\t\t\t\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t\t</BlockControls>\n\t\t\t\t) }\n\t\t\t\t{ isEntityAvailable && (\n\t\t\t\t\t<TemplatePartInnerBlocks\n\t\t\t\t\t\tpostId={ templatePartId }\n\t\t\t\t\t\thasInnerBlocks={ innerBlocks.length > 0 }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t\t{ ! isPlaceholder && ! isResolved && <Spinner /> }\n\t\t\t</TagName>\n\t\t</>\n\t);\n}\n"]}