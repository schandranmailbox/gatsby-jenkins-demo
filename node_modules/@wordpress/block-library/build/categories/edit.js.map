{"version":3,"sources":["@wordpress/block-library/src/categories/edit.js"],"names":["CategoriesEdit","attributes","displayAsDropdown","showHierarchy","showPostCounts","setAttributes","selectId","select","getEntityRecords","isResolving","query","per_page","hide_empty","categories","isRequesting","getCategoriesList","parentId","length","filter","parent","getCategoryListClassName","level","toggleAttribute","attributeName","newValue","renderCategoryName","name","trim","renderCategoryList","categoriesList","map","category","renderCategoryListItem","childCategories","id","link","count","childCategory","renderCategoryDropdown","renderCategoryDropdownItem","pin"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { times, unescape } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tPanelBody,\n\tPlaceholder,\n\tSpinner,\n\tToggleControl,\n\tVisuallyHidden,\n} from '@wordpress/components';\nimport { useInstanceId } from '@wordpress/compose';\nimport { useSelect } from '@wordpress/data';\nimport { InspectorControls, useBlockProps } from '@wordpress/block-editor';\nimport { __ } from '@wordpress/i18n';\nimport { pin } from '@wordpress/icons';\n\nexport default function CategoriesEdit( {\n\tattributes: { displayAsDropdown, showHierarchy, showPostCounts },\n\tsetAttributes,\n} ) {\n\tconst selectId = useInstanceId( CategoriesEdit, 'blocks-category-select' );\n\tconst { categories, isRequesting } = useSelect( ( select ) => {\n\t\tconst { getEntityRecords } = select( 'core' );\n\t\tconst { isResolving } = select( 'core/data' );\n\t\tconst query = { per_page: -1, hide_empty: true };\n\t\treturn {\n\t\t\tcategories: getEntityRecords( 'taxonomy', 'category', query ),\n\t\t\tisRequesting: isResolving( 'core', 'getEntityRecords', [\n\t\t\t\t'taxonomy',\n\t\t\t\t'category',\n\t\t\t\tquery,\n\t\t\t] ),\n\t\t};\n\t}, [] );\n\tconst getCategoriesList = ( parentId ) => {\n\t\tif ( ! categories?.length ) {\n\t\t\treturn [];\n\t\t}\n\t\tif ( parentId === null ) {\n\t\t\treturn categories;\n\t\t}\n\t\treturn categories.filter( ( { parent } ) => parent === parentId );\n\t};\n\tconst getCategoryListClassName = ( level ) => {\n\t\treturn `wp-block-categories__list wp-block-categories__list-level-${ level }`;\n\t};\n\tconst toggleAttribute = ( attributeName ) => ( newValue ) =>\n\t\tsetAttributes( { [ attributeName ]: newValue } );\n\tconst renderCategoryName = ( name ) =>\n\t\t! name ? __( '(Untitled)' ) : unescape( name ).trim();\n\n\tconst renderCategoryList = () => {\n\t\tconst parentId = showHierarchy ? 0 : null;\n\t\tconst categoriesList = getCategoriesList( parentId );\n\t\treturn (\n\t\t\t<ul className={ getCategoryListClassName( 0 ) }>\n\t\t\t\t{ categoriesList.map( ( category ) =>\n\t\t\t\t\trenderCategoryListItem( category, 0 )\n\t\t\t\t) }\n\t\t\t</ul>\n\t\t);\n\t};\n\tconst renderCategoryListItem = ( category, level ) => {\n\t\tconst childCategories = getCategoriesList( category.id );\n\t\tconst { id, link, count, name } = category;\n\t\treturn (\n\t\t\t<li key={ id }>\n\t\t\t\t<a href={ link } target=\"_blank\" rel=\"noreferrer noopener\">\n\t\t\t\t\t{ renderCategoryName( name ) }\n\t\t\t\t</a>\n\t\t\t\t{ showPostCounts && (\n\t\t\t\t\t<span className=\"wp-block-categories__post-count\">\n\t\t\t\t\t\t{ ` (${ count })` }\n\t\t\t\t\t</span>\n\t\t\t\t) }\n\t\t\t\t{ showHierarchy && !! childCategories.length && (\n\t\t\t\t\t<ul className={ getCategoryListClassName( level + 1 ) }>\n\t\t\t\t\t\t{ childCategories.map( ( childCategory ) =>\n\t\t\t\t\t\t\trenderCategoryListItem( childCategory, level + 1 )\n\t\t\t\t\t\t) }\n\t\t\t\t\t</ul>\n\t\t\t\t) }\n\t\t\t</li>\n\t\t);\n\t};\n\tconst renderCategoryDropdown = () => {\n\t\tconst parentId = showHierarchy ? 0 : null;\n\t\tconst categoriesList = getCategoriesList( parentId );\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<VisuallyHidden as=\"label\" htmlFor={ selectId }>\n\t\t\t\t\t{ __( 'Categories' ) }\n\t\t\t\t</VisuallyHidden>\n\t\t\t\t<select\n\t\t\t\t\tid={ selectId }\n\t\t\t\t\tclassName=\"wp-block-categories__dropdown\"\n\t\t\t\t>\n\t\t\t\t\t{ categoriesList.map( ( category ) =>\n\t\t\t\t\t\trenderCategoryDropdownItem( category, 0 )\n\t\t\t\t\t) }\n\t\t\t\t</select>\n\t\t\t</>\n\t\t);\n\t};\n\tconst renderCategoryDropdownItem = ( category, level ) => {\n\t\tconst { id, count, name } = category;\n\t\tconst childCategories = getCategoriesList( id );\n\t\treturn [\n\t\t\t<option key={ id }>\n\t\t\t\t{ times( level * 3, () => '\\xa0' ) }\n\t\t\t\t{ renderCategoryName( name ) }\n\t\t\t\t{ showPostCounts && ` (${ count })` }\n\t\t\t</option>,\n\t\t\tshowHierarchy &&\n\t\t\t\t!! childCategories.length &&\n\t\t\t\tchildCategories.map( ( childCategory ) =>\n\t\t\t\t\trenderCategoryDropdownItem( childCategory, level + 1 )\n\t\t\t\t),\n\t\t];\n\t};\n\n\treturn (\n\t\t<div { ...useBlockProps() }>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Categories settings' ) }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Display as dropdown' ) }\n\t\t\t\t\t\tchecked={ displayAsDropdown }\n\t\t\t\t\t\tonChange={ toggleAttribute( 'displayAsDropdown' ) }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show hierarchy' ) }\n\t\t\t\t\t\tchecked={ showHierarchy }\n\t\t\t\t\t\tonChange={ toggleAttribute( 'showHierarchy' ) }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show post counts' ) }\n\t\t\t\t\t\tchecked={ showPostCounts }\n\t\t\t\t\t\tonChange={ toggleAttribute( 'showPostCounts' ) }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t{ isRequesting && (\n\t\t\t\t<Placeholder icon={ pin } label={ __( 'Categories' ) }>\n\t\t\t\t\t<Spinner />\n\t\t\t\t</Placeholder>\n\t\t\t) }\n\t\t\t{ ! isRequesting &&\n\t\t\t\t( displayAsDropdown\n\t\t\t\t\t? renderCategoryDropdown()\n\t\t\t\t\t: renderCategoryList() ) }\n\t\t</div>\n\t);\n}\n"]}