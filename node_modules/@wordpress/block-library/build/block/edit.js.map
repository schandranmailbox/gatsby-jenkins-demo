{"version":3,"sources":["@wordpress/block-library/src/block/edit.js"],"names":["ReusableBlockEdit","ref","attributes","clientId","hasAlreadyRendered","RecursionProvider","select","persistedBlock","coreStore","getEntityRecord","hasResolvedBlock","hasFinishedResolution","hasResolved","isMissing","reusableBlocksStore","convertBlockToStatic","__experimentalConvertBlockToStatic","id","blocks","onInput","onChange","title","setTitle","innerBlocksProps","value","renderAppender","length","undefined","InnerBlocks","ButtonBlockAppender","blockProps","ungroup"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport {\n\tuseEntityBlockEditor,\n\tuseEntityProp,\n\tstore as coreStore,\n} from '@wordpress/core-data';\nimport {\n\tPlaceholder,\n\tSpinner,\n\tToolbarGroup,\n\tToolbarButton,\n\tTextControl,\n\tPanelBody,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport {\n\t__experimentalUseInnerBlocksProps as useInnerBlocksProps,\n\t__experimentalUseNoRecursiveRenders as useNoRecursiveRenders,\n\tInnerBlocks,\n\tBlockControls,\n\tInspectorControls,\n\tuseBlockProps,\n\tWarning,\n} from '@wordpress/block-editor';\nimport { store as reusableBlocksStore } from '@wordpress/reusable-blocks';\nimport { ungroup } from '@wordpress/icons';\n\nexport default function ReusableBlockEdit( { attributes: { ref }, clientId } ) {\n\tconst [ hasAlreadyRendered, RecursionProvider ] = useNoRecursiveRenders(\n\t\tref\n\t);\n\tconst { isMissing, hasResolved } = useSelect(\n\t\t( select ) => {\n\t\t\tconst persistedBlock = select( coreStore ).getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'wp_block',\n\t\t\t\tref\n\t\t\t);\n\t\t\tconst hasResolvedBlock = select(\n\t\t\t\tcoreStore\n\t\t\t).hasFinishedResolution( 'getEntityRecord', [\n\t\t\t\t'postType',\n\t\t\t\t'wp_block',\n\t\t\t\tref,\n\t\t\t] );\n\t\t\treturn {\n\t\t\t\thasResolved: hasResolvedBlock,\n\t\t\t\tisMissing: hasResolvedBlock && ! persistedBlock,\n\t\t\t};\n\t\t},\n\t\t[ ref, clientId ]\n\t);\n\n\tconst {\n\t\t__experimentalConvertBlockToStatic: convertBlockToStatic,\n\t} = useDispatch( reusableBlocksStore );\n\n\tconst [ blocks, onInput, onChange ] = useEntityBlockEditor(\n\t\t'postType',\n\t\t'wp_block',\n\t\t{ id: ref }\n\t);\n\tconst [ title, setTitle ] = useEntityProp(\n\t\t'postType',\n\t\t'wp_block',\n\t\t'title',\n\t\tref\n\t);\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{},\n\t\t{\n\t\t\tvalue: blocks,\n\t\t\tonInput,\n\t\t\tonChange,\n\t\t\trenderAppender: blocks?.length\n\t\t\t\t? undefined\n\t\t\t\t: InnerBlocks.ButtonBlockAppender,\n\t\t}\n\t);\n\n\tconst blockProps = useBlockProps();\n\n\tif ( hasAlreadyRendered ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __( 'Block cannot be rendered inside itself.' ) }\n\t\t\t\t</Warning>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( isMissing ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Warning>\n\t\t\t\t\t{ __( 'Block has been deleted or is unavailable.' ) }\n\t\t\t\t</Warning>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( ! hasResolved ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Placeholder>\n\t\t\t\t\t<Spinner />\n\t\t\t\t</Placeholder>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<RecursionProvider>\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<BlockControls>\n\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\tonClick={ () => convertBlockToStatic( clientId ) }\n\t\t\t\t\t\t\tlabel={ __( 'Convert to regular blocks' ) }\n\t\t\t\t\t\t\ticon={ ungroup }\n\t\t\t\t\t\t\tshowTooltip\n\t\t\t\t\t\t/>\n\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t</BlockControls>\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody>\n\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\tlabel={ __( 'Name' ) }\n\t\t\t\t\t\t\tvalue={ title }\n\t\t\t\t\t\t\tonChange={ setTitle }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t</InspectorControls>\n\t\t\t\t<div className=\"block-library-block__reusable-block-container\">\n\t\t\t\t\t{ <div { ...innerBlocksProps } /> }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</RecursionProvider>\n\t);\n}\n"]}