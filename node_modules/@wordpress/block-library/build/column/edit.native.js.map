{"version":3,"sources":["@wordpress/block-library/src/column/edit.native.js"],"names":["isWider","alignmentHelpers","ColumnEdit","attributes","setAttributes","hasChildren","isSelected","getStylesFromColorScheme","isParentSelected","contentStyle","columns","selectedColumnIndex","parentAlignment","clientId","blockWidth","verticalAlignment","width","valueUnit","screenWidth","Math","floor","Dimensions","get","widthUnit","setWidthUnit","updateAlignment","alignment","onChangeWidth","nextWidth","widthWithUnit","onChangeUnit","nextUnit","widthWithoutUnit","parseFloat","onChange","renderAppender","columnWidth","isScreenWidthEqual","styles","columnAppender","wideColumnAppender","columnPlaceholder","columnPlaceholderDark","columnPlaceholderNotSelected","undefined","CSS_UNITS","innerBlocksBottomSpace","ColumnEditWrapper","props","getVerticalAlignmentRemap","flexBase","select","getBlockCount","getBlockRootClientId","getSelectedBlockClientId","getBlocks","getBlockOrder","getBlockAttributes","selectedBlockClientId","parentId","blockOrder","indexOf","withPreferredColorScheme"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, Dimensions } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { withSelect } from '@wordpress/data';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport { useEffect, useState, useCallback } from '@wordpress/element';\nimport {\n\tInnerBlocks,\n\tBlockControls,\n\tBlockVerticalAlignmentToolbar,\n\tInspectorControls,\n} from '@wordpress/block-editor';\nimport {\n\tPanelBody,\n\tFooterMessageControl,\n\tUnitControl,\n\tgetValueAndUnit,\n\talignmentHelpers,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n/**\n * Internal dependencies\n */\nimport styles from './editor.scss';\nimport ColumnsPreview from './column-preview';\nimport {\n\tgetWidths,\n\tgetWidthWithUnit,\n\tisPercentageUnit,\n\tCSS_UNITS,\n} from '../columns/utils';\n\nconst { isWider } = alignmentHelpers;\n\nfunction ColumnEdit( {\n\tattributes,\n\tsetAttributes,\n\thasChildren,\n\tisSelected,\n\tgetStylesFromColorScheme,\n\tisParentSelected,\n\tcontentStyle,\n\tcolumns,\n\tselectedColumnIndex,\n\tparentAlignment,\n\tclientId,\n\tblockWidth,\n} ) {\n\tconst { verticalAlignment, width } = attributes;\n\tconst { valueUnit = '%' } = getValueAndUnit( width ) || {};\n\n\tconst screenWidth = Math.floor( Dimensions.get( 'window' ).width );\n\n\tconst [ widthUnit, setWidthUnit ] = useState( valueUnit || '%' );\n\n\tconst updateAlignment = ( alignment ) => {\n\t\tsetAttributes( { verticalAlignment: alignment } );\n\t};\n\n\tuseEffect( () => {\n\t\tsetWidthUnit( valueUnit );\n\t}, [ valueUnit ] );\n\n\tuseEffect( () => {\n\t\tif ( ! verticalAlignment && parentAlignment ) {\n\t\t\tupdateAlignment( parentAlignment );\n\t\t}\n\t}, [] );\n\n\tconst onChangeWidth = ( nextWidth ) => {\n\t\tconst widthWithUnit = getWidthWithUnit( nextWidth, widthUnit );\n\n\t\tsetAttributes( {\n\t\t\twidth: widthWithUnit,\n\t\t} );\n\t};\n\n\tconst onChangeUnit = ( nextUnit ) => {\n\t\tsetWidthUnit( nextUnit );\n\t\tconst widthWithoutUnit = parseFloat(\n\t\t\twidth || getWidths( columns )[ selectedColumnIndex ]\n\t\t);\n\n\t\tsetAttributes( {\n\t\t\twidth: getWidthWithUnit( widthWithoutUnit, nextUnit ),\n\t\t} );\n\t};\n\n\tconst onChange = ( nextWidth ) => {\n\t\tif ( isPercentageUnit( widthUnit ) || ! widthUnit ) {\n\t\t\treturn;\n\t\t}\n\t\tonChangeWidth( nextWidth );\n\t};\n\n\tconst renderAppender = useCallback( () => {\n\t\tconst { width: columnWidth } = contentStyle[ clientId ];\n\t\tconst isScreenWidthEqual = columnWidth === screenWidth;\n\n\t\tif ( isSelected ) {\n\t\t\treturn (\n\t\t\t\t<View\n\t\t\t\t\tstyle={\n\t\t\t\t\t\t( isWider( screenWidth, 'mobile' ) ||\n\t\t\t\t\t\t\tisScreenWidthEqual ) &&\n\t\t\t\t\t\t( hasChildren\n\t\t\t\t\t\t\t? styles.columnAppender\n\t\t\t\t\t\t\t: styles.wideColumnAppender )\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<InnerBlocks.ButtonBlockAppender />\n\t\t\t\t</View>\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t}, [ contentStyle[ clientId ], screenWidth, isSelected, hasChildren ] );\n\n\tif ( ! isSelected && ! hasChildren ) {\n\t\treturn (\n\t\t\t<View\n\t\t\t\tstyle={ [\n\t\t\t\t\t! isParentSelected &&\n\t\t\t\t\t\tgetStylesFromColorScheme(\n\t\t\t\t\t\t\tstyles.columnPlaceholder,\n\t\t\t\t\t\t\tstyles.columnPlaceholderDark\n\t\t\t\t\t\t),\n\t\t\t\t\tstyles.columnPlaceholderNotSelected,\n\t\t\t\t\tcontentStyle[ clientId ],\n\t\t\t\t] }\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<BlockControls>\n\t\t\t\t<BlockVerticalAlignmentToolbar\n\t\t\t\t\tonChange={ updateAlignment }\n\t\t\t\t\tvalue={ verticalAlignment }\n\t\t\t\t/>\n\t\t\t</BlockControls>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Column settings' ) }>\n\t\t\t\t\t<UnitControl\n\t\t\t\t\t\tlabel={ __( 'Width' ) }\n\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\tmax={ isPercentageUnit( widthUnit ) ? 100 : undefined }\n\t\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\t\tonComplete={ onChangeWidth }\n\t\t\t\t\t\tonUnitChange={ onChangeUnit }\n\t\t\t\t\t\tdecimalNum={ 1 }\n\t\t\t\t\t\tvalue={ getWidths( columns )[ selectedColumnIndex ] }\n\t\t\t\t\t\tunit={ widthUnit }\n\t\t\t\t\t\tunits={ CSS_UNITS }\n\t\t\t\t\t\tpreview={\n\t\t\t\t\t\t\t<ColumnsPreview\n\t\t\t\t\t\t\t\tcolumnWidths={ getWidths( columns, false ) }\n\t\t\t\t\t\t\t\tselectedColumnIndex={ selectedColumnIndex }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t\t<PanelBody>\n\t\t\t\t\t<FooterMessageControl\n\t\t\t\t\t\tlabel={ __(\n\t\t\t\t\t\t\t'Note: Column layout may vary between themes and screen sizes'\n\t\t\t\t\t\t) }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<View\n\t\t\t\tstyle={ [\n\t\t\t\t\tisSelected && hasChildren && styles.innerBlocksBottomSpace,\n\t\t\t\t\tcontentStyle[ clientId ],\n\t\t\t\t] }\n\t\t\t>\n\t\t\t\t<InnerBlocks\n\t\t\t\t\trenderAppender={ renderAppender }\n\t\t\t\t\tparentWidth={ contentStyle[ clientId ].width }\n\t\t\t\t\tblockWidth={ blockWidth }\n\t\t\t\t/>\n\t\t\t</View>\n\t\t</>\n\t);\n}\n\nfunction ColumnEditWrapper( props ) {\n\tconst { verticalAlignment } = props.attributes;\n\n\tconst getVerticalAlignmentRemap = ( alignment ) => {\n\t\tif ( ! alignment ) return styles.flexBase;\n\t\treturn {\n\t\t\t...styles.flexBase,\n\t\t\t...styles[ `is-vertically-aligned-${ alignment }` ],\n\t\t};\n\t};\n\n\treturn (\n\t\t<View style={ getVerticalAlignmentRemap( verticalAlignment ) }>\n\t\t\t<ColumnEdit { ...props } />\n\t\t</View>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst {\n\t\t\tgetBlockCount,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlocks,\n\t\t\tgetBlockOrder,\n\t\t\tgetBlockAttributes,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\t\tconst isSelected = selectedBlockClientId === clientId;\n\n\t\tconst parentId = getBlockRootClientId( clientId );\n\t\tconst hasChildren = !! getBlockCount( clientId );\n\t\tconst isParentSelected =\n\t\t\tselectedBlockClientId && selectedBlockClientId === parentId;\n\n\t\tconst blockOrder = getBlockOrder( parentId );\n\n\t\tconst selectedColumnIndex = blockOrder.indexOf( clientId );\n\t\tconst columns = getBlocks( parentId );\n\n\t\tconst parentAlignment = getBlockAttributes( parentId )\n\t\t\t?.verticalAlignment;\n\n\t\treturn {\n\t\t\thasChildren,\n\t\t\tisParentSelected,\n\t\t\tisSelected,\n\t\t\tselectedColumnIndex,\n\t\t\tcolumns,\n\t\t\tparentAlignment,\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( ColumnEditWrapper );\n"]}