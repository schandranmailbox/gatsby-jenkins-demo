{"version":3,"sources":["@wordpress/block-editor/src/components/inserter/quick-inserter.js"],"names":["classnames","useState","useEffect","__","Button","useSelect","useDispatch","InserterSearchForm","InserterSearchResults","useInsertionPoint","usePatternsState","useBlockTypesState","SEARCH_THRESHOLD","SHOWN_BLOCK_TYPES","SHOWN_BLOCK_PATTERNS","QuickInserter","onSelect","rootClientId","clientId","isAppender","selectBlockOnInsert","filterValue","setFilterValue","destinationRootClientId","onInsertBlocks","blockTypes","patterns","showPatterns","length","showSearch","select","getSettings","getBlockIndex","setInserterIsOpened","__experimentalSetIsInserterOpened","blockIndex","__unstableSetInsertionPoint","onBrowseAll","value"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useState, useEffect } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { Button } from '@wordpress/components';\nimport { useSelect, useDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport InserterSearchForm from './search-form';\nimport InserterSearchResults from './search-results';\nimport useInsertionPoint from './hooks/use-insertion-point';\nimport usePatternsState from './hooks/use-patterns-state';\nimport useBlockTypesState from './hooks/use-block-types-state';\n\nconst SEARCH_THRESHOLD = 6;\nconst SHOWN_BLOCK_TYPES = 6;\nconst SHOWN_BLOCK_PATTERNS = 2;\n\nexport default function QuickInserter( {\n\tonSelect,\n\trootClientId,\n\tclientId,\n\tisAppender,\n\tselectBlockOnInsert,\n} ) {\n\tconst [ filterValue, setFilterValue ] = useState( '' );\n\tconst [ destinationRootClientId, onInsertBlocks ] = useInsertionPoint( {\n\t\tonSelect,\n\t\trootClientId,\n\t\tclientId,\n\t\tisAppender,\n\t\tselectBlockOnInsert,\n\t} );\n\tconst [ blockTypes ] = useBlockTypesState(\n\t\tdestinationRootClientId,\n\t\tonInsertBlocks\n\t);\n\n\tconst [ patterns ] = usePatternsState( onInsertBlocks );\n\tconst showPatterns =\n\t\t! destinationRootClientId && patterns.length && !! filterValue;\n\tconst showSearch =\n\t\t( showPatterns && patterns.length > SEARCH_THRESHOLD ) ||\n\t\tblockTypes.length > SEARCH_THRESHOLD;\n\n\tconst { setInserterIsOpened, blockIndex } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getSettings, getBlockIndex } = select(\n\t\t\t\t'core/block-editor'\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tsetInserterIsOpened: getSettings()\n\t\t\t\t\t.__experimentalSetIsInserterOpened,\n\t\t\t\tblockIndex: getBlockIndex( clientId, rootClientId ),\n\t\t\t};\n\t\t},\n\t\t[ clientId, rootClientId ]\n\t);\n\n\tuseEffect( () => {\n\t\tif ( setInserterIsOpened ) {\n\t\t\tsetInserterIsOpened( false );\n\t\t}\n\t}, [ setInserterIsOpened ] );\n\n\tconst { __unstableSetInsertionPoint } = useDispatch( 'core/block-editor' );\n\n\t// When clicking Browse All select the appropriate block so as\n\t// the insertion point can work as expected\n\tconst onBrowseAll = () => {\n\t\t__unstableSetInsertionPoint( rootClientId, blockIndex );\n\t\tsetInserterIsOpened( true );\n\t};\n\n\treturn (\n\t\t<div\n\t\t\tclassName={ classnames( 'block-editor-inserter__quick-inserter', {\n\t\t\t\t'has-search': showSearch,\n\t\t\t\t'has-expand': setInserterIsOpened,\n\t\t\t} ) }\n\t\t>\n\t\t\t{ showSearch && (\n\t\t\t\t<InserterSearchForm\n\t\t\t\t\tvalue={ filterValue }\n\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\tsetFilterValue( value );\n\t\t\t\t\t} }\n\t\t\t\t\tplaceholder={ __( 'Search for a block' ) }\n\t\t\t\t/>\n\t\t\t) }\n\n\t\t\t<div className=\"block-editor-inserter__quick-inserter-results\">\n\t\t\t\t<InserterSearchResults\n\t\t\t\t\tfilterValue={ filterValue }\n\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\tisAppender={ isAppender }\n\t\t\t\t\tselectBlockOnInsert={ selectBlockOnInsert }\n\t\t\t\t\tmaxBlockPatterns={ showPatterns ? SHOWN_BLOCK_PATTERNS : 0 }\n\t\t\t\t\tmaxBlockTypes={ SHOWN_BLOCK_TYPES }\n\t\t\t\t\tisDraggable={ false }\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t{ setInserterIsOpened && (\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"block-editor-inserter__quick-inserter-expand\"\n\t\t\t\t\tonClick={ onBrowseAll }\n\t\t\t\t\taria-label={ __(\n\t\t\t\t\t\t'Browse all. This will open the main inserter panel in the editor toolbar.'\n\t\t\t\t\t) }\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Browse all' ) }\n\t\t\t\t</Button>\n\t\t\t) }\n\t\t</div>\n\t);\n}\n"]}