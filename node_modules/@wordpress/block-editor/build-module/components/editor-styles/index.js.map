{"version":3,"sources":["@wordpress/block-editor/src/components/editor-styles/index.js"],"names":["compact","map","tinycolor","useCallback","useRef","transformStyles","syncDarkThemeBodyClassname","node","backgroundColor","window","getComputedStyle","getPropertyValue","ownerDocument","body","getElementsByTagName","getLuminance","classList","remove","add","useEditorStyles","styles","nodes","current","forEach","styleElement","removeChild","updatedStyles","updatedCSS","createElement","innerHTML","appendChild"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAT,EAAkBC,GAAlB,QAA6B,QAA7B;AACA,OAAOC,SAAP,MAAsB,YAAtB;AAEA;AACA;AACA;;AACA,SAASC,WAAT,EAAsBC,MAAtB,QAAoC,oBAApC;AAEA;AACA;AACA;;AACA,OAAOC,eAAP,MAA4B,8BAA5B;;AAEA,SAASC,0BAAT,CAAqCC,IAArC,EAA4C;AAC3C,MAAMC,eAAe,GAAGC,MAAM,CAC5BC,gBADsB,CACJH,IADI,EACE,IADF,EAEtBI,gBAFsB,CAEJ,kBAFI,CAAxB;AAD2C,MAKnCC,aALmC,GAKjBL,IALiB,CAKnCK,aALmC;AAM3C,MAAMC,IAAI,GAAGD,aAAa,CAACE,oBAAd,CAAoC,MAApC,EAA8C,CAA9C,CAAb;;AAEA,MAAKZ,SAAS,CAAEM,eAAF,CAAT,CAA6BO,YAA7B,KAA8C,GAAnD,EAAyD;AACxDF,IAAAA,IAAI,CAACG,SAAL,CAAeC,MAAf,CAAuB,eAAvB;AACA,GAFD,MAEO;AACNJ,IAAAA,IAAI,CAACG,SAAL,CAAeE,GAAf,CAAoB,eAApB;AACA;AACD;;AAED,eAAe,SAASC,eAAT,CAA0BC,MAA1B,EAAmC;AACjD,MAAMC,KAAK,GAAGjB,MAAM,CAAE,EAAF,CAApB;AAEA,SAAOD,WAAW,CACjB,UAAEI,IAAF,EAAY;AACX,QAAK,CAAEA,IAAP,EAAc;AACbc,MAAAA,KAAK,CAACC,OAAN,CAAcC,OAAd,CAAuB,UAAEC,YAAF;AAAA,eACtBA,YAAY,CAACZ,aAAb,CAA2BC,IAA3B,CAAgCY,WAAhC,CAA6CD,YAA7C,CADsB;AAAA,OAAvB;AAGA;AACA;;AAED,QAAME,aAAa,GAAGrB,eAAe,CACpCe,MADoC,EAEpC,wBAFoC,CAArC;AARW,QAaHR,aAbG,GAaeL,IAbf,CAaHK,aAbG;AAcXS,IAAAA,KAAK,CAACC,OAAN,GAAgBrB,GAAG,CAAED,OAAO,CAAE0B,aAAF,CAAT,EAA4B,UAAEC,UAAF,EAAkB;AAChE,UAAMH,YAAY,GAAGZ,aAAa,CAACgB,aAAd,CAA6B,OAA7B,CAArB;AACAJ,MAAAA,YAAY,CAACK,SAAb,GAAyBF,UAAzB;AACAf,MAAAA,aAAa,CAACC,IAAd,CAAmBiB,WAAnB,CAAgCN,YAAhC;AAEA,aAAOA,YAAP;AACA,KANkB,CAAnB;AAQAlB,IAAAA,0BAA0B,CAAEC,IAAF,CAA1B;AACA,GAxBgB,EAyBjB,CAAEa,MAAF,CAzBiB,CAAlB;AA2BA","sourcesContent":["/**\n * External dependencies\n */\nimport { compact, map } from 'lodash';\nimport tinycolor from 'tinycolor2';\n\n/**\n * WordPress dependencies\n */\nimport { useCallback, useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport transformStyles from '../../utils/transform-styles';\n\nfunction syncDarkThemeBodyClassname( node ) {\n\tconst backgroundColor = window\n\t\t.getComputedStyle( node, null )\n\t\t.getPropertyValue( 'background-color' );\n\n\tconst { ownerDocument } = node;\n\tconst body = ownerDocument.getElementsByTagName( 'body' )[ 0 ];\n\n\tif ( tinycolor( backgroundColor ).getLuminance() > 0.5 ) {\n\t\tbody.classList.remove( 'is-dark-theme' );\n\t} else {\n\t\tbody.classList.add( 'is-dark-theme' );\n\t}\n}\n\nexport default function useEditorStyles( styles ) {\n\tconst nodes = useRef( [] );\n\n\treturn useCallback(\n\t\t( node ) => {\n\t\t\tif ( ! node ) {\n\t\t\t\tnodes.current.forEach( ( styleElement ) =>\n\t\t\t\t\tstyleElement.ownerDocument.body.removeChild( styleElement )\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst updatedStyles = transformStyles(\n\t\t\t\tstyles,\n\t\t\t\t'.editor-styles-wrapper'\n\t\t\t);\n\n\t\t\tconst { ownerDocument } = node;\n\t\t\tnodes.current = map( compact( updatedStyles ), ( updatedCSS ) => {\n\t\t\t\tconst styleElement = ownerDocument.createElement( 'style' );\n\t\t\t\tstyleElement.innerHTML = updatedCSS;\n\t\t\t\townerDocument.body.appendChild( styleElement );\n\n\t\t\t\treturn styleElement;\n\t\t\t} );\n\n\t\t\tsyncDarkThemeBodyClassname( node );\n\t\t},\n\t\t[ styles ]\n\t);\n}\n"]}