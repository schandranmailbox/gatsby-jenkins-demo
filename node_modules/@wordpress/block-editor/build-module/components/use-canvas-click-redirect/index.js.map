{"version":3,"sources":["@wordpress/block-editor/src/components/use-canvas-click-redirect/index.js"],"names":["overEvery","findLast","useEffect","focus","isTextField","placeCaretAtHorizontalEdge","isTabbableTextField","tabbable","isTabbableIndex","useCanvasClickRedirect","ref","onMouseDown","event","target","current","focusableNodes","focusable","find","preventDefault","addEventListener"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,QAApC;AAEA;AACA;AACA;;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,KAAT,EAAgBC,WAAhB,EAA6BC,0BAA7B,QAA+D,gBAA/D;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAMC,mBAAmB,GAAGN,SAAS,CAAE,CACtCI,WADsC,EAEtCD,KAAK,CAACI,QAAN,CAAeC,eAFuB,CAAF,CAArC;AAKA,OAAO,SAASC,sBAAT,CAAiCC,GAAjC,EAAuC;AAC7CR,EAAAA,SAAS,CAAE,YAAM;AAChB,aAASS,WAAT,CAAsBC,KAAtB,EAA8B;AAC7B;AACA,UAAKA,KAAK,CAACC,MAAN,KAAiBH,GAAG,CAACI,OAA1B,EAAoC;AACnC;AACA;;AAED,UAAMC,cAAc,GAAGZ,KAAK,CAACa,SAAN,CAAgBC,IAAhB,CAAsBP,GAAG,CAACI,OAA1B,CAAvB;AACA,UAAMD,MAAM,GAAGZ,QAAQ,CAAEc,cAAF,EAAkBT,mBAAlB,CAAvB;;AAEA,UAAK,CAAEO,MAAP,EAAgB;AACf;AACA;;AAEDR,MAAAA,0BAA0B,CAAEQ,MAAF,EAAU,IAAV,CAA1B;AACAD,MAAAA,KAAK,CAACM,cAAN;AACA;;AAEDR,IAAAA,GAAG,CAACI,OAAJ,CAAYK,gBAAZ,CAA8B,WAA9B,EAA2CR,WAA3C;AAEA,WAAO,YAAM;AACZD,MAAAA,GAAG,CAACI,OAAJ,CAAYK,gBAAZ,CAA8B,WAA9B,EAA2CR,WAA3C;AACA,KAFD;AAGA,GAvBQ,EAuBN,EAvBM,CAAT;AAwBA","sourcesContent":["/**\n * External dependencies\n */\nimport { overEvery, findLast } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect } from '@wordpress/element';\nimport { focus, isTextField, placeCaretAtHorizontalEdge } from '@wordpress/dom';\n\n/**\n * Given an element, returns true if the element is a tabbable text field, or\n * false otherwise.\n *\n * @param {Element} element Element to test.\n *\n * @return {boolean} Whether element is a tabbable text field.\n */\nconst isTabbableTextField = overEvery( [\n\tisTextField,\n\tfocus.tabbable.isTabbableIndex,\n] );\n\nexport function useCanvasClickRedirect( ref ) {\n\tuseEffect( () => {\n\t\tfunction onMouseDown( event ) {\n\t\t\t// Only handle clicks on the canvas, not the content.\n\t\t\tif ( event.target !== ref.current ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst focusableNodes = focus.focusable.find( ref.current );\n\t\t\tconst target = findLast( focusableNodes, isTabbableTextField );\n\n\t\t\tif ( ! target ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tplaceCaretAtHorizontalEdge( target, true );\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tref.current.addEventListener( 'mousedown', onMouseDown );\n\n\t\treturn () => {\n\t\t\tref.current.addEventListener( 'mousedown', onMouseDown );\n\t\t};\n\t}, [] );\n}\n"]}